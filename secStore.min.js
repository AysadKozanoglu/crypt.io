/* https://github.com/jas-/secStore.js */
(function(a){a.fn.secStore=function(j){var g={appID:"secStore.js",storage:"local",uuid:"",data:{},aes:false,debug:false,callback:function(){},preCallback:function(){},errCallback:function(){}};var b=b||{init:function(l){var k=e.merge(l,g);return e.init(k)}};var e=e||{init:function(l){((l.preCallback)&&(a.isFunction(l.preCallback)))?l.preCallback(this):false;l.uuid=(l.aes)?h.key(l):l.uuid;var k=(c.size(f.toJSON(l.data))>0)?f.save(l,l.appID,l.data):f.retrieve(l,l.appID);((l.callback)&&(a.isFunction(l.callback)))?l.callback(k):false;return k},merge:function(l,k){return a.extend({},k,l)}};var f=f||{quota:function(n,m,p){var k=/local|session/.test(m)?1024*1025*5:1024*4;var o=k-unescape(encodeURIComponent(JSON.stringify(m))).length;if(o<=0){d.error(n,"Maximum quota ("+k+"k) for "+m+" has been met, cannot continue");return false}(p)?d.debug(n,"_storage.quota: Maximum quota ("+k+"k) for "+m+" has not been met. Current total: "+o+"k"):false;return true},save:function(q,n,m){var l=false;if(f.quota(q.appID,q.storage,q.debug)){var p=f.retrieve(q,n);if(c.size(p)>0){a.extend(m,p)}m=(q.aes)?sjcl.encrypt(q.uuid,f.fromJSON(m)):f.fromJSON(m);switch(q.storage){case"cookie":this._cookie.save(q,n,m);l=true;break;case"local":this._local.save(q,n,m);l=true;break;case"session":this._session.save(q,n,m);l=true;break;default:this._local.save(q,n,m);l=true;break}}return l},retrieve:function(n,m){var l={};switch(n.storage){case"cookie":l=this._cookie.retrieve(n,m);break;case"local":l=this._local.retrieve(n,m);break;case"session":l=this._session.retrieve(n,m);break;default:l=this._local.retrieve(n,m);break}if(c.size(f.toJSON(l))>0){l=(n.aes)?sjcl.decrypt(n.uuid,l):l;return(/string/.test(typeof(l)))?f.toJSON(l):l}(n.debug)?d.debug(n.appID,'_storage.retrieve: An error occured retrieving "'+m+'" from "'+n.storage+'"'):false;return false},fromJSON:function(k){return(/object/.test(typeof(k)))?JSON.stringify(k):k},toJSON:function(k){return(/string/.test(typeof(k)))?JSON.parse(k):k},_cookie:{save:function(p,m,l){var n=new Date();n.setTime(n.getTime()+(30*24*60*60*1000));document.cookie=m+"="+l+";expires="+n.toGMTString()+";path=/;domain="+this.domain();(p.debug)?d.debug(p.appID,"_cookies.save: "+m+" => "+l):false;return true},retrieve:function(q,m){var n,l,r,p=document.cookie.split(";");for(n=0;n<p.length;n++){l=p[n].substr(0,p[n].indexOf("="));r=p[n].substr(p[n].indexOf("=")+1);l=l.replace(/^\s+|\s+$/g,"");if(l==m){(q.debug)?d.debug(q.appID,"_cookies.retrieve: "+m+" => "+r):false;return unescape(r)}}return false},domain:function(){return location.hostname}},_local:{save:function(n,m,l){(n.debug)?d.debug(n.appID,"_local.save: "+m+" => "+l):false;return localStorage.setItem(m,l)},retrieve:function(n,m){var l=localStorage.getItem(m);(n.debug)?d.debug(n.appID,"_local.retrieve: "+m+" => "+l):false;return(l)?l:false}},_session:{save:function(n,m,l){(n.debug)?d.debug(n.appID,"_session.save: "+m+" => "+l):false;return localStorage.setItem(m,l)},retrieve:function(n,m){var l=sessionStorage.getItem(m);(n.debug)?d.debug(n.appID,"_session.retrieve: "+m+" => "+l):false;return(l)?l:false}}};var h=h||{key:function(l){(l.debug)?d.debug(l.appID,"_crypto.key: Prepared key"):false;var k=h.uid();return sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(k,h.salt(k),1000,256))},uid:function(){var k=window.navigator.appName+window.navigator.appCodeName+window.navigator.product+window.navigator.productSub+window.navigator.appVersion+window.navigator.buildID+window.navigator.userAgent+window.navigator.language+window.navigator.platform+window.navigator.oscpu;return k.replace(/\s/,"")},salt:function(o){var l=h.iv(o);var m=[];m[0]=sjcl.hash.sha256.hash(o);var n=[];n=m[0];var k;for(i=1;i<3;i++){m[i]=sjcl.hash.sha256.hash(m[i-1].concat(l));k=n.concat(m[i])}return JSON.stringify(sjcl.codec.hex.fromBits(k))},iv:function(k){return(k)?encodeURI(k.replace(/-/gi,"").substring(16,Math.ceil(16*k.length)%k.length)):false}};var c=c||{inspect:function(l,k){a.each(k,function(m,n){if((/object|array/.test(typeof(n)))&&(c.size(n)>0)){(l.debug)?d.debug(l.appID,"_libs.inspect: Examining "+m+" ("+typeof(n)+")"):false;c.inspect(l,n)}else{(l.debug)?d.debug(l.appID,"_libs.inspect: "+m+" => "+n):false}})},size:function(k){var l=0;if(/object/.test(typeof(k))){a.each(k,function(n,m){if(k.hasOwnProperty(n)){l++}})}else{if(/array/.test(typeof(k))){l=k.length}}return l}};var d=d||{debug:function(l,k){return(/function/.test(typeof(console.debug)))?console.debug("["+l+"] (DEBUG) "+k):false},info:function(l,k){return(/function/.test(typeof(console.info)))?console.info("["+l+"] (INFO) "+k):false},warn:function(l,k){return(/function/.test(typeof(console.warn)))?console.warn("["+l+"] (WARN) "+k):false},error:function(l,k){return(/function/.test(typeof(console.error)))?console.error("["+l+"] (ERROR) "+k):false}};if(b[j]){return b[j].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof j==="object")||(!j)){return b.init.apply(this,arguments)}else{d.error("Method "+j+" does not exist")}}return true}})(jQuery);