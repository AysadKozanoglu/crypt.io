/* https://github.com/jas-/secStore.js */
(function(a){a.fn.secStore=function(k){var h={appID:"secStore.js",storage:"local",uuid:false,data:{},aes:false,debug:false,callback:function(){},preCallback:function(){},errCallback:function(){}};var b=b||{init:function(m){var l=f.merge(m,h);return f.init(l)}};var f=f||{init:function(m){((m.preCallback)&&(a.isFunction(m.preCallback)))?m.preCallback(this):false;m.uuid=(m.aes)?j.key(m):m.uuid;var l=(c.size(g.toJSON(m.data))>0)?g.save(m,m.appID,m.data):g.retrieve(m,m.appID);((m.callback)&&(a.isFunction(m.callback)))?m.callback(l):false;return l},merge:function(m,l){return a.extend({},l,m)}};var g=g||{quota:function(o,n,p){var m=/local|session/.test(n)?1024*1025*5:1024*4;_t=m-unescape(encodeURIComponent(JSON.stringify(n))).length;if(_t<=0){d.error(o,"Maximum quota ("+m+"k) for "+n+" has been met, cannot continue");return false}(p)?d.debug(o,"_storage.quota: Maximum quota ("+m+"k) for "+n+" has not been met. Current total: "+_t+"k"):false;return true},save:function(p,n,m){var l=false;if(g.quota(p.appID,p.storage,p.debug)){e=g.retrieve(p,n);if(c.size(e)>0){a.extend(m,e)}m=(p.aes)?sjcl.encrypt(p.uuid,g.fromJSON(m)):g.fromJSON(m);switch(p.storage){case"cookie":this._cookie.save(p,n,m);l=true;break;case"local":this._local.save(p,n,m);l=true;break;case"session":this._session.save(p,n,m);l=true;break;default:this._local.save(p,n,m);l=true;break}}return l},retrieve:function(n,m){var l={};switch(n.storage){case"cookie":l=this._cookie.retrieve(n,m);break;case"local":l=this._local.retrieve(n,m);break;case"session":l=this._session.retrieve(n,m);break;default:l=this._local.retrieve(n,m);break}if(c.size(g.toJSON(l))>0){l=(n.aes)?sjcl.decrypt(n.uuid,l):l;return(/string/.test(typeof(l)))?g.toJSON(l):l}(n.debug)?d.debug(n.appID,'_storage.retrieve: An error occured retrieving "'+m+'" from "'+n.storage+'"'):false;return false},fromJSON:function(l){return(/object/.test(typeof(l)))?JSON.stringify(l):l},toJSON:function(l){return(/string/.test(typeof(l)))?JSON.parse(l):l},_cookie:{save:function(p,m,l){var n=new Date();n.setTime(n.getTime()+(30*24*60*60*1000));document.cookie=m+"="+l+";expires="+n.toGMTString()+";path=/;domain="+this.domain();(p.debug)?d.debug(p.appID,"_cookies.save: "+m+" => "+l):false;return true},retrieve:function(q,m){var n,l,r,p=document.cookie.split(";");for(n=0;n<p.length;n++){l=p[n].substr(0,p[n].indexOf("="));r=p[n].substr(p[n].indexOf("=")+1);l=l.replace(/^\s+|\s+$/g,"");if(l==m){(q.debug)?d.debug(q.appID,"_cookies.retrieve: "+m+" => "+r):false;return unescape(r)}}return false},domain:function(){return location.hostname}},_local:{save:function(n,m,l){(n.debug)?d.debug(n.appID,"_local.save: "+m+" => "+l):false;return localStorage.setItem(m,l)},retrieve:function(n,m){var l=localStorage.getItem(m);(n.debug)?d.debug(n.appID,"_local.retrieve: "+m+" => "+l):false;return(l)?l:false}},_session:{save:function(n,m,l){(n.debug)?d.debug(n.appID,"_session.save: "+m+" => "+l):false;return localStorage.setItem(m,l)},retrieve:function(m,l){x=sessionStorage.getItem(l);(m.debug)?d.debug(m.appID,"_session.retrieve: "+l+" => "+x):false;return(x)?x:false}}};var j=j||{key:function(m){(m.debug)?d.debug(m.appID,"_crypto.key: Prepared key"):false;var l=j.uid();return sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(l,j.salt(l),1000,256))},uid:function(){var l=window.navigator.appName+window.navigator.appCodeName+window.navigator.product+window.navigator.productSub+window.navigator.appVersion+window.navigator.buildID+window.navigator.userAgent+window.navigator.language+window.navigator.platform+window.navigator.oscpu;return l.replace(/\s/,"")},salt:function(m){var l=j.iv(m);_h=[];_h[0]=sjcl.hash.sha256.hash(m);_r=[];_r=_h[0],_d;for(i=1;i<3;i++){_h[i]=sjcl.hash.sha256.hash(_h[i-1].concat(l));_d=_r.concat(_h[i])}return JSON.stringify(sjcl.codec.hex.fromBits(_d))},iv:function(l){return(l)?encodeURI(l.replace(/-/gi,"").substring(16,Math.ceil(16*l.length)%l.length)):false}};var c=c||{inspect:function(m,l){a.each(l,function(n,o){if((/object|array/.test(typeof(o)))&&(c.size(o)>0)){(m.debug)?d.debug(m.appID,"_libs.inspect: Examining "+n+" ("+typeof(o)+")"):false;c.inspect(m,o)}else{(m.debug)?d.debug(m.appID,"_libs.inspect: "+n+" => "+o):false}})},size:function(l){var m=0;if(/object/.test(typeof(l))){a.each(l,function(o,n){if(l.hasOwnProperty(o)){m++}})}else{if(/array/.test(typeof(l))){m=l.length}}return m}};var d=d||{debug:function(m,l){return(/function/.test(typeof(console.debug)))?console.debug("["+m+"] (DEBUG) "+l):false},info:function(m,l){return(/function/.test(typeof(console.info)))?console.info("["+m+"] (INFO) "+l):false},warn:function(m,l){return(/function/.test(typeof(console.warn)))?console.warn("["+m+"] (WARN) "+l):false},error:function(m,l){return(/function/.test(typeof(console.error)))?console.error("["+m+"] (ERROR) "+l):false}};if(b[k]){return b[k].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof k==="object")||(!k)){return b.init.apply(this,arguments)}else{d.error("Method "+k+" does not exist")}}return true}})(jQuery);